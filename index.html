<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CryptoWatch - Monitoramento de Criptomoedas</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        .gradient-bg {
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
        }
        .coin-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2);
        }
        .positive {
            color: #10b981;
        }
        .negative {
            color: #ef4444;
        }
        .loading-spinner {
            border-top-color: #3b82f6;
            animation: spinner 1s linear infinite;
        }
        @keyframes spinner {
            to { transform: rotate(360deg); }
        }
    </style>
</head>
<body class="bg-gray-100 min-h-screen">
    <!-- Header -->
    <header class="gradient-bg text-white shadow-lg">
        <div class="container mx-auto px-4 py-6">
            <div class="flex flex-col md:flex-row justify-between items-center">
                <div class="flex items-center mb-4 md:mb-0">
                    <i class="fab fa-bitcoin text-3xl mr-3 text-yellow-400"></i>
                    <h1 class="text-2xl font-bold">CryptoWatch</h1>
                </div>
                <div class="flex items-center space-x-4">
                    <div class="relative">
                        <select id="currency-selector" class="bg-gray-800 text-white px-4 py-2 rounded-lg appearance-none pr-8 focus:outline-none focus:ring-2 focus:ring-blue-500">
                            <option value="usd">USD ($)</option>
                            <option value="eur">EUR (€)</option>
                            <option value="brl">BRL (R$)</option>
                        </select>
                        <div class="absolute inset-y-0 right-0 flex items-center pr-2 pointer-events-none">
                            <i class="fas fa-chevron-down text-gray-400"></i>
                        </div>
                    </div>
                    <button id="refresh-btn" class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg flex items-center">
                        <i class="fas fa-sync-alt mr-2"></i>
                        Atualizar
                    </button>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="container mx-auto px-4 py-8">
        <!-- Search and Filter -->
        <div class="mb-8">
            <div class="flex flex-col md:flex-row gap-4">
                <div class="relative flex-grow">
                    <input type="text" id="search-input" placeholder="Buscar criptomoedas..." class="w-full px-4 py-3 rounded-lg border border-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-500">
                    <i class="fas fa-search absolute right-3 top-3.5 text-gray-400"></i>
                </div>
                <select id="market-cap-filter" class="bg-white px-4 py-3 rounded-lg border border-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-500">
                    <option value="all">Todas as moedas</option>
                    <option value="top10">Top 10</option>
                    <option value="top50">Top 50</option>
                    <option value="top100">Top 100</option>
                </select>
            </div>
        </div>

        <!-- Stats Overview -->
        <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
            <div class="bg-white rounded-lg shadow-md p-6">
                <div class="flex items-center">
                    <div class="p-3 rounded-full bg-blue-100 text-blue-600 mr-4">
                        <i class="fas fa-chart-line text-xl"></i>
                    </div>
                    <div>
                        <p class="text-gray-500">Capitalização de Mercado</p>
                        <h3 id="total-market-cap" class="text-2xl font-bold">Carregando...</h3>
                    </div>
                </div>
            </div>
            <div class="bg-white rounded-lg shadow-md p-6">
                <div class="flex items-center">
                    <div class="p-3 rounded-full bg-green-100 text-green-600 mr-4">
                        <i class="fas fa-exchange-alt text-xl"></i>
                    </div>
                    <div>
                        <p class="text-gray-500">Volume 24h</p>
                        <h3 id="total-volume" class="text-2xl font-bold">Carregando...</h3>
                    </div>
                </div>
            </div>
            <div class="bg-white rounded-lg shadow-md p-6">
                <div class="flex items-center">
                    <div class="p-3 rounded-full bg-purple-100 text-purple-600 mr-4">
                        <i class="fas fa-coins text-xl"></i>
                    </div>
                    <div>
                        <p class="text-gray-500">Moedas Ativas</p>
                        <h3 id="active-coins" class="text-2xl font-bold">Carregando...</h3>
                    </div>
                </div>
            </div>
        </div>

        <!-- Crypto Table -->
        <div class="bg-white rounded-lg shadow-md overflow-hidden mb-8">
            <div class="overflow-x-auto">
                <table class="min-w-full divide-y divide-gray-200">
                    <thead class="bg-gray-50">
                        <tr>
                            <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">#</th>
                            <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Moeda</th>
                            <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Preço</th>
                            <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">24h %</th>
                            <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Capitalização</th>
                            <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Volume (24h)</th>
                            <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Ações</th>
                        </tr>
                    </thead>
                    <tbody id="crypto-table-body" class="bg-white divide-y divide-gray-200">
                        <tr>
                            <td colspan="7" class="px-6 py-12 text-center">
                                <div class="flex justify-center">
                                    <div class="w-12 h-12 border-4 border-blue-500 border-t-transparent rounded-full loading-spinner"></div>
                                </div>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Top Gainers & Losers -->
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-8">
            <div class="bg-white rounded-lg shadow-md overflow-hidden">
                <div class="bg-green-600 px-6 py-3">
                    <h3 class="text-white font-semibold"><i class="fas fa-arrow-up mr-2"></i> Maiores Altas (24h)</h3>
                </div>
                <div id="top-gainers" class="divide-y divide-gray-200">
                    <div class="px-6 py-4 text-center">
                        <div class="flex justify-center">
                            <div class="w-8 h-8 border-2 border-green-500 border-t-transparent rounded-full loading-spinner"></div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="bg-white rounded-lg shadow-md overflow-hidden">
                <div class="bg-red-600 px-6 py-3">
                    <h3 class="text-white font-semibold"><i class="fas fa-arrow-down mr-2"></i> Maiores Baixas (24h)</h3>
                </div>
                <div id="top-losers" class="divide-y divide-gray-200">
                    <div class="px-6 py-4 text-center">
                        <div class="flex justify-center">
                            <div class="w-8 h-8 border-2 border-red-500 border-t-transparent rounded-full loading-spinner"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- News Section -->
        <div class="bg-white rounded-lg shadow-md overflow-hidden mb-8">
            <div class="bg-blue-600 px-6 py-3">
                <h3 class="text-white font-semibold"><i class="fas fa-newspaper mr-2"></i> Últimas Notícias</h3>
            </div>
            <div id="news-container" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 p-6">
                <div class="border border-gray-200 rounded-lg overflow-hidden hover:shadow-lg transition-shadow">
                    <div class="h-48 bg-gray-200 animate-pulse"></div>
                    <div class="p-4">
                        <div class="h-6 bg-gray-200 rounded animate-pulse mb-2"></div>
                        <div class="h-4 bg-gray-200 rounded animate-pulse w-3/4 mb-4"></div>
                        <div class="h-3 bg-gray-200 rounded animate-pulse mb-1"></div>
                        <div class="h-3 bg-gray-200 rounded animate-pulse w-5/6"></div>
                    </div>
                </div>
                <div class="border border-gray-200 rounded-lg overflow-hidden hover:shadow-lg transition-shadow">
                    <div class="h-48 bg-gray-200 animate-pulse"></div>
                    <div class="p-4">
                        <div class="h-6 bg-gray-200 rounded animate-pulse mb-2"></div>
                        <div class="h-4 bg-gray-200 rounded animate-pulse w-3/4 mb-4"></div>
                        <div class="h-3 bg-gray-200 rounded animate-pulse mb-1"></div>
                        <div class="h-3 bg-gray-200 rounded animate-pulse w-5/6"></div>
                    </div>
                </div>
                <div class="border border-gray-200 rounded-lg overflow-hidden hover:shadow-lg transition-shadow">
                    <div class="h-48 bg-gray-200 animate-pulse"></div>
                    <div class="p-4">
                        <div class="h-6 bg-gray-200 rounded animate-pulse mb-2"></div>
                        <div class="h-4 bg-gray-200 rounded animate-pulse w-3/4 mb-4"></div>
                        <div class="h-3 bg-gray-200 rounded animate-pulse mb-1"></div>
                        <div class="h-3 bg-gray-200 rounded animate-pulse w-5/6"></div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Footer -->
    <footer class="gradient-bg text-white py-8">
        <div class="container mx-auto px-4">
            <div class="flex flex-col md:flex-row justify-between items-center">
                <div class="mb-4 md:mb-0">
                    <h2 class="text-xl font-bold mb-2">CryptoWatch</h2>
                    <p class="text-gray-300">Monitoramento de criptomoedas em tempo real</p>
                </div>
                <div class="flex space-x-6">
                    <a href="#" class="hover:text-blue-300 transition-colors"><i class="fab fa-twitter text-xl"></i></a>
                    <a href="#" class="hover:text-blue-300 transition-colors"><i class="fab fa-telegram text-xl"></i></a>
                    <a href="#" class="hover:text-blue-300 transition-colors"><i class="fab fa-github text-xl"></i></a>
                    <a href="#" class="hover:text-blue-300 transition-colors"><i class="fab fa-discord text-xl"></i></a>
                </div>
            </div>
            <div class="border-t border-gray-700 mt-6 pt-6 text-center text-gray-400 text-sm">
                <p>© 2023 CryptoWatch. Todos os direitos reservados.</p>
                <p class="mt-2">Dados fornecidos pela CoinGecko API.</p>
            </div>
        </div>
    </footer>

    <script>
        // Global variables
        let currentCurrency = 'usd';
        let allCoinsData = [];
        let filteredCoinsData = [];
        
        // DOM elements
        const currencySelector = document.getElementById('currency-selector');
        const refreshBtn = document.getElementById('refresh-btn');
        const searchInput = document.getElementById('search-input');
        const marketCapFilter = document.getElementById('market-cap-filter');
        const cryptoTableBody = document.getElementById('crypto-table-body');
        const topGainers = document.getElementById('top-gainers');
        const topLosers = document.getElementById('top-losers');
        const totalMarketCap = document.getElementById('total-market-cap');
        const totalVolume = document.getElementById('total-volume');
        const activeCoins = document.getElementById('active-coins');
        const newsContainer = document.getElementById('news-container');
        
        // Currency symbols
        const currencySymbols = {
            usd: '$',
            eur: '€',
            brl: 'R$'
        };
        
        // Format numbers
        function formatNumber(num, digits = 2) {
            const lookup = [
                { value: 1, symbol: "" },
                { value: 1e3, symbol: "k" },
                { value: 1e6, symbol: "M" },
                { value: 1e9, symbol: "B" },
                { value: 1e12, symbol: "T" }
            ];
            
            const rx = /\.0+$|(\.[0-9]*[1-9])0+$/;
            const item = lookup.slice().reverse().find(item => num >= item.value);
            
            return item ? (num / item.value).toFixed(digits).replace(rx, "$1") + item.symbol : "0";
        }
        
        // Format price
        function formatPrice(price, currency) {
            if (price < 1) {
                return `${currencySymbols[currency]}${price.toFixed(4)}`;
            } else if (price < 100) {
                return `${currencySymbols[currency]}${price.toFixed(2)}`;
            } else {
                return `${currencySymbols[currency]}${formatNumber(price)}`;
            }
        }
        
        // Fetch crypto data
        async function fetchCryptoData(currency = 'usd') {
            try {
                // Show loading state
                cryptoTableBody.innerHTML = `
                    <tr>
                        <td colspan="7" class="px-6 py-12 text-center">
                            <div class="flex justify-center">
                                <div class="w-12 h-12 border-4 border-blue-500 border-t-transparent rounded-full loading-spinner"></div>
                            </div>
                        </td>
                    </tr>
                `;
                
                // Fetch data from CoinGecko API
                const response = await fetch(`https://api.coingecko.com/api/v3/coins/markets?vs_currency=${currency}&order=market_cap_desc&per_page=100&page=1&sparkline=false&price_change_percentage=24h`);
                allCoinsData = await response.json();
                
                // Update global stats
                updateGlobalStats(allCoinsData, currency);
                
                // Filter and display data
                filterAndDisplayCoins();
                
                // Update top gainers and losers
                updateTopGainersAndLosers(allCoinsData, currency);
                
            } catch (error) {
                console.error('Error fetching crypto data:', error);
                cryptoTableBody.innerHTML = `
                    <tr>
                        <td colspan="7" class="px-6 py-12 text-center text-red-500">
                            <div class="flex flex-col items-center">
                                <i class="fas fa-exclamation-triangle text-4xl mb-4"></i>
                                <p>Erro ao carregar dados. Por favor, tente novamente.</p>
                                <button onclick="fetchCryptoData(currentCurrency)" class="mt-4 bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg">
                                    <i class="fas fa-sync-alt mr-2"></i>
                                    Tentar novamente
                                </button>
                            </div>
                        </td>
                    </tr>
                `;
            }
        }
        
        // Update global stats
        function updateGlobalStats(coinsData, currency) {
            const totalMarketCapValue = coinsData.reduce((sum, coin) => sum + coin.market_cap, 0);
            const totalVolumeValue = coinsData.reduce((sum, coin) => sum + coin.total_volume, 0);
            
            totalMarketCap.textContent = `${currencySymbols[currency]}${formatNumber(totalMarketCapValue)}`;
            totalVolume.textContent = `${currencySymbols[currency]}${formatNumber(totalVolumeValue)}`;
            activeCoins.textContent = coinsData.length;
        }
        
        // Filter and display coins
        function filterAndDisplayCoins() {
            // Apply market cap filter
            let filteredData = [...allCoinsData];
            const filterValue = marketCapFilter.value;
            
            if (filterValue === 'top10') {
                filteredData = filteredData.slice(0, 10);
            } else if (filterValue === 'top50') {
                filteredData = filteredData.slice(0, 50);
            } else if (filterValue === 'top100') {
                filteredData = filteredData.slice(0, 100);
            }
            
            // Apply search filter
            const searchTerm = searchInput.value.toLowerCase();
            if (searchTerm) {
                filteredData = filteredData.filter(coin => 
                    coin.name.toLowerCase().includes(searchTerm) || 
                    coin.symbol.toLowerCase().includes(searchTerm)
                );
            }
            
            filteredCoinsData = filteredData;
            
            // Update table
            updateCryptoTable(filteredData, currentCurrency);
        }
        
        // Update crypto table
        function updateCryptoTable(coinsData, currency) {
            if (coinsData.length === 0) {
                cryptoTableBody.innerHTML = `
                    <tr>
                        <td colspan="7" class="px-6 py-12 text-center text-gray-500">
                            Nenhuma criptomoeda encontrada com os critérios de busca.
                        </td>
                    </tr>
                `;
                return;
            }
            
            cryptoTableBody.innerHTML = coinsData.map((coin, index) => `
                <tr class="hover:bg-gray-50 transition-colors">
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">${index + 1}</td>
                    <td class="px-6 py-4 whitespace-nowrap">
                        <div class="flex items-center">
                            <img src="${coin.image}" alt="${coin.name}" class="w-8 h-8 rounded-full mr-3">
                            <div>
                                <div class="font-medium text-gray-900">${coin.name}</div>
                                <div class="text-sm text-gray-500">${coin.symbol.toUpperCase()}</div>
                            </div>
                        </div>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">
                        ${formatPrice(coin.current_price, currency)}
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm ${coin.price_change_percentage_24h >= 0 ? 'positive' : 'negative'}">
                        ${coin.price_change_percentage_24h >= 0 ? '+' : ''}${coin.price_change_percentage_24h.toFixed(2)}%
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                        ${currencySymbols[currency]}${formatNumber(coin.market_cap)}
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                        ${currencySymbols[currency]}${formatNumber(coin.total_volume)}
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                        <button class="text-blue-600 hover:text-blue-800 mr-3" onclick="showCoinDetails('${coin.id}')">
                            <i class="fas fa-chart-line"></i>
                        </button>
                        <button class="text-green-600 hover:text-green-800" onclick="addToWatchlist('${coin.id}')">
                            <i class="fas fa-star"></i>
                        </button>
                    </td>
                </tr>
            `).join('');
        }
        
        // Update top gainers and losers
        function updateTopGainersAndLosers(coinsData, currency) {
            // Sort by 24h change
            const sortedByChange = [...coinsData].sort((a, b) => 
                b.price_change_percentage_24h - a.price_change_percentage_24h
            );
            
            // Top 5 gainers
            const gainers = sortedByChange.slice(0, 5);
            topGainers.innerHTML = gainers.map(coin => `
                <div class="px-6 py-3 flex items-center justify-between hover:bg-gray-50 transition-colors">
                    <div class="flex items-center">
                        <img src="${coin.image}" alt="${coin.name}" class="w-6 h-6 rounded-full mr-3">
                        <span class="font-medium">${coin.symbol.toUpperCase()}</span>
                    </div>
                    <span class="positive font-semibold">+${coin.price_change_percentage_24h.toFixed(2)}%</span>
                </div>
            `).join('');
            
            // Top 5 losers
            const losers = sortedByChange.slice(-5).reverse();
            topLosers.innerHTML = losers.map(coin => `
                <div class="px-6 py-3 flex items-center justify-between hover:bg-gray-50 transition-colors">
                    <div class="flex items-center">
                        <img src="${coin.image}" alt="${coin.name}" class="w-6 h-6 rounded-full mr-3">
                        <span class="font-medium">${coin.symbol.toUpperCase()}</span>
                    </div>
                    <span class="negative font-semibold">${coin.price_change_percentage_24h.toFixed(2)}%</span>
                </div>
            `).join('');
        }
        
        // Fetch crypto news
        async function fetchCryptoNews() {
            try {
                // Simulate news fetch (in a real app, you would use a news API)
                setTimeout(() => {
                    const sampleNews = [
                        {
                            title: "Bitcoin atinge novo recorde em meio a adoção institucional",
                            source: "CryptoNews",
                            date: "15 min atrás",
                            description: "O preço do Bitcoin subiu para US$ 45.000 após anúncio de nova empresa listada na Fortune 500 adotando a criptomoeda."
                        },
                        {
                            title: "Ethereum 2.0: Atualização traz redução de 99% no consumo de energia",
                            source: "Blockchain Daily",
                            date: "2 horas atrás",
                            description: "A tão esperada atualização do Ethereum foi implementada com sucesso, marcando uma nova era para a segunda maior criptomoeda."
                        },
                        {
                            title: "Reguladores globais discutem framework para criptomoedas",
                            source: "Finance Watch",
                            date: "5 horas atrás",
                            description: "Representantes de 20 países se reuniram para discutir a criação de um marco regulatório internacional para criptoativos."
                        }
                    ];
                    
                    newsContainer.innerHTML = sampleNews.map(news => `
                        <div class="border border-gray-200 rounded-lg overflow-hidden hover:shadow-lg transition-shadow">
                            <div class="h-48 bg-gradient-to-r from-blue-500 to-purple-600 flex items-center justify-center text-white">
                                <i class="fas fa-newspaper text-6xl opacity-50"></i>
                            </div>
                            <div class="p-4">
                                <h4 class="font-bold text-lg mb-2">${news.title}</h4>
                                <div class="flex items-center text-sm text-gray-500 mb-3">
                                    <span>${news.source}</span>
                                    <span class="mx-2">•</span>
                                    <span>${news.date}</span>
                                </div>
                                <p class="text-gray-700">${news.description}</p>
                                <button class="mt-4 text-blue-600 hover:text-blue-800 font-medium">
                                    Ler mais <i class="fas fa-arrow-right ml-1"></i>
                                </button>
                            </div>
                        </div>
                    `).join('');
                }, 1500);
                
            } catch (error) {
                console.error('Error fetching news:', error);
                newsContainer.innerHTML = `
                    <div class="col-span-3 text-center py-8 text-red-500">
                        <i class="fas fa-exclamation-triangle text-3xl mb-3"></i>
                        <p>Não foi possível carregar as notícias no momento.</p>
                    </div>
                `;
            }
        }
        
        // Show coin details (placeholder)
        function showCoinDetails(coinId) {
            alert(`Detalhes da moeda com ID: ${coinId}\nEm uma implementação real, isso abriria um modal ou página de detalhes.`);
        }
        
        // Add to watchlist (placeholder)
        function addToWatchlist(coinId) {
            const coin = allCoinsData.find(c => c.id === coinId);
            alert(`Adicionado à watchlist: ${coin.name} (${coin.symbol.toUpperCase()})`);
        }
        
        // Event listeners
        currencySelector.addEventListener('change', (e) => {
            currentCurrency = e.target.value;
            fetchCryptoData(currentCurrency);
        });
        
        refreshBtn.addEventListener('click', () => {
            fetchCryptoData(currentCurrency);
        });
        
        searchInput.addEventListener('input', () => {
            filterAndDisplayCoins();
        });
        
        marketCapFilter.addEventListener('change', () => {
            filterAndDisplayCoins();
        });
        
        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            fetchCryptoData(currentCurrency);
            fetchCryptoNews();
            
            // Auto-refresh every 60 seconds
            setInterval(() => {
                fetchCryptoData(currentCurrency);
            }, 60000);
        });
    </script>
</body>
</html>
